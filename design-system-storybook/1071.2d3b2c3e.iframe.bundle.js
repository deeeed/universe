(self.webpackChunk_siteed_design_system=self.webpackChunk_siteed_design_system||[]).push([[1071],{"./src/providers/ModalProviderPaper.tsx":(__unused_webpack_module,exports,__webpack_require__)=>{var _interopRequireDefault=__webpack_require__("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModalProvider=exports.ModalContext=void 0;var _toConsumableArray2=_interopRequireDefault(__webpack_require__("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),_asyncToGenerator2=_interopRequireDefault(__webpack_require__("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),_slicedToArray2=_interopRequireDefault(__webpack_require__("./node_modules/@babel/runtime/helpers/slicedToArray.js")),_react=function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}(__webpack_require__("./node_modules/react/index.js")),_reactNativePaper=__webpack_require__("./node_modules/react-native-paper/lib/module/index.js"),_logger=__webpack_require__("./src/utils/logger.ts"),_ThemeProvider=__webpack_require__("./src/providers/ThemeProvider.tsx"),_jsxRuntime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r})(e)}var ModalContext=exports.ModalContext=(0,_react.createContext)(void 0),logger=_logger.baseLogger.extend("ModalProvider"),ModalProvider=exports.ModalProvider=function ModalProvider(_ref){var _ref3,children=_ref.children,theme=(0,_ThemeProvider.useTheme)(),defaultStyles=(0,_react.useMemo)((function(){return function getDefaultStyles(theme){return{modalContainer:{flex:1,justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:theme.colors.surface,padding:20,borderRadius:8,margin:20,maxWidth:"90%",maxHeight:"90%"}}}(theme)}),[theme]),_useState=(0,_react.useState)([]),_useState2=(0,_slicedToArray2.default)(_useState,2),modalStack=_useState2[0],setModalStack=_useState2[1],handleModalDismiss=(0,_react.useCallback)((function(){if(modalStack.length>0){var currentModal=modalStack[modalStack.length-1];null==currentModal||currentModal.resolve(currentModal.initialData),setModalStack((function(prevStack){return prevStack.slice(0,-1)}))}}),[modalStack]),modalIdCounter=(0,_react.useRef)(0),openModal=(0,_react.useCallback)((_ref3=(0,_asyncToGenerator2.default)((function*(_ref2){var initialData=_ref2.initialData,modalProperties=_ref2.modalProps,render=_ref2.render;return new Promise((function(resolve,reject){var modalId=modalIdCounter.current++,wrapResolve=function wrapResolve(value){logger.debug("modal wrapResolve",value),setModalStack((function(prevStack){return prevStack.filter((function(modal){return modal.id!==modalId}))})),resolve(value)},wrapReject=function wrapReject(error){logger.debug("modal wrapReject",error),setModalStack((function(prevStack){return prevStack.filter((function(modal){return modal.id!==modalId}))})),reject(error)},content=render({resolve:wrapResolve,reject:wrapReject,onChange:function wrapOnChange(value){logger.debug("modal onChange",value),setModalStack((function(prevStack){return prevStack.map((function(modal){return modal.id===modalId?Object.assign({},modal,{initialData:value}):modal}))}))}});setModalStack((function(prevStack){return[].concat((0,_toConsumableArray2.default)(prevStack),[{id:modalId,content,props:{initialData,modalProps:modalProperties,render},resolve:wrapResolve,reject:wrapReject,initialData}])}))}))})),function(_x){return _ref3.apply(this,arguments)}),[]),dismiss=(0,_react.useCallback)((function(){return new Promise((function(resolvePromise){0!==modalStack.length?(handleModalDismiss(),resolvePromise(!0)):resolvePromise(!1)}))}),[handleModalDismiss,modalStack.length]),dismissAll=(0,_react.useCallback)((function(){modalStack.forEach((function(modal){return modal.resolve(modal.initialData)})),setModalStack([])}),[modalStack]),contextValue=(0,_react.useMemo)((function(){return{openModal,dismiss,dismissAll}}),[openModal,dismiss,dismissAll]);return(0,_jsxRuntime.jsxs)(ModalContext.Provider,{value:contextValue,children:[children,(0,_jsxRuntime.jsx)(_reactNativePaper.Portal,{children:modalStack.map((function(modal){var _modal$props$modalPro,_modal$props$modalPro2,_modal$props$modalPro3,_modal$props$modalPro4,_modal$props$modalPro5,showBackdrop=null==(_modal$props$modalPro=null==(_modal$props$modalPro2=modal.props.modalProps)?void 0:_modal$props$modalPro2.showBackdrop)||_modal$props$modalPro,customStyles=null!=(_modal$props$modalPro3=null==(_modal$props$modalPro4=modal.props.modalProps)?void 0:_modal$props$modalPro4.styles)?_modal$props$modalPro3:{};Object.assign({},defaultStyles.modalContainer,showBackdrop&&{backgroundColor:"rgba(0, 0, 0, 0.5)"},customStyles.modalContainer),Object.assign({},defaultStyles.modalContent,customStyles.modalContent);return(0,_jsxRuntime.jsx)(_reactNativePaper.Modal,{visible:!0,onDismiss:handleModalDismiss,contentContainerStyle:{padding:20,backgroundColor:theme.colors.background},dismissable:!1!==(null==(_modal$props$modalPro5=modal.props.modalProps)?void 0:_modal$props$modalPro5.closeOnOutsideTouch),children:modal.content},modal.id)}))})]})};try{ModalProvider.displayName="ModalProvider",ModalProvider.__docgenInfo={description:"",displayName:"ModalProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/providers/ModalProviderPaper.tsx#ModalProvider"]={docgenInfo:ModalProvider.__docgenInfo,name:"ModalProvider",path:"src/providers/ModalProviderPaper.tsx#ModalProvider"})}catch(__react_docgen_typescript_loader_error){}}}]);